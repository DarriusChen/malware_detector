# 將upload info寫進db
from fastapi import UploadFile
import shutil
from pathlib import Path

def insert_info(connection,action,time):
    db = connection["Files"]
    collection = db["upload"]

    upload_info = {
        "action":action,
        "time":time
    }

    collection.insert_one(upload_info)


async def save_upload_file(upload_file: UploadFile, path):
    contents = await upload_file.read() # 不用await會出錯(檔案寫壞掉)
    
    with open(path+"\\"+upload_file.filename,'wb') as f:
        f.write(contents)

    # try:
    #     with destination.open("wb") as f:
    #         shutil.copyfileobj(upload_file.file, f)
    # finally:
    #     upload_file.file.close()